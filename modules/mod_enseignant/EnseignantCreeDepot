<?php
include_once '../connexion.php';

class EnseignantCreeDepot {

    private $controller;

    public function __construct() {
        $this->controller = new cont_enseignant_depot();
        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            $this->controller->creerDepot($_POST['nom'], $_POST['description'], $_POST['date_limite'], $_POST['heure_limite'], 1); // 1 = ID de l'enseignant
        } else {
            $this->controller->afficherFormulaireCreation();
        }
    }
    public function creerDepot($nom, $description, $dateLimite, $heureLimite, $enseignantId) {
        $query = "INSERT INTO depots (nom, description, date_limite, heure_limite, enseignant_id) 
                  VALUES (:nom, :description, :date_limite, :heure_limite, :enseignant_id)";
        $stmt = connexion::$bdd->prepare($query);
        $stmt->execute([
            'nom' => $nom,
            'description' => $description,
            'date_limite' => $dateLimite,
            'heure_limite' => $heureLimite,
            'enseignant_id' => $enseignantId
        ]);
        return $stmt->rowCount() > 0;
    }


    public function afficherFormulaireCreation() {
        echo "<h1>Créer un espace de dépôt</h1>
              <form method='POST'>
                  <label>Nom : </label>
                  <input type='text' name='nom' required><br>
                  <label>Description : </label>
                  <textarea name='description'></textarea><br>
                  <label>Date limite : </label>
                  <input type='date' name='date_limite' required><br>
                  <label>Heure limite : </label>
                  <input type='time' name='heure_limite' required><br>
                  <button type='submit'>Créer</button>
              </form>";
    }
}
?>
